<div class='projects mt-5'>
  <tbs-progress indeterminate value="$ctrl.projectsReady" description='Projects'>
  </tbs-progress>
  <tbs-sidebar sections='$ctrl.sections'></tbs-sidebar>
  <image-viewer images="$ctrl.currentImages"></image-viewer>
  <div class='card w-100' ng-if='$ctrl.projectsReady'>
    <ul class="list-group list-group-flush pt-2">
      <li ng-repeat='project in $ctrl.projects' id='project{{$index}}' class='list-group-item section-{{$index}} mb-2'>
        <div class="project-heading d-flex justify-content-between align-items-start">
          <h3>{{project.name}}</h3>
          <button type="button" class='btn btn-light emphasize-interaction' ng-if='project.images.length'
            ng-click='$ctrl.currentImages = project.images'  data-bs-toggle="modal" data-bs-target="#image-viewer"><span class="fa fa-images fa-2x"></span></button>
        </div>
        <p class='lead'><strong>Goal: </strong>{{project.goal}}</p>
        <div id='project{{$index}}-steps' class='accordion mx-lg-5 mx-md-0 my-5'>
          <div ng-repeat='step in project.steps' class='accordion-item'>
            <h5 id='project{{$parent.$index}}-step{{$index}}-heading' class='accordion-header'>
              <button class="accordion-button"
                ng-class="{ collapsed: !$first }" type="button" data-bs-toggle="collapse"
                data-bs-target="#project{{$parent.$index}}-step{{$index}}-detail" aria-expanded="{{ $first }}"
                aria-controls="project{{$parent.$index}}-step{{$index}}-detail">
                <small class="fa fa-check-circle me-2"></small>{{step.heading}}
              </button>
            </h5>
            <div id='project{{$parent.$index}}-step{{$index}}-detail' class='accordion-collapse collapse' ng-class="{ show: $first }"
              aria-labelledby="project{{$parent.$index}}-step{{$index}}-heading"
              data-bs-parent="#project{{$parent.$index}}-steps">
              <div class='accordion-body'>
                <p class='project-step' ng-repeat='paragraph in step.detail.split("\n")'>
                  {{paragraph}}
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body d-flex justify-content-end" ng-if='project.documents.length'>
          Give it a try! =>
          <a class='ms-3' ng-repeat='doc in project.documents' href='{{doc.path}}' target='_blank'
            rel="noopener noreferrer">{{doc.name}}</a>
        </div>
      </li>
    </ul>
  </div>
</div>
