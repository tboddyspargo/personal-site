<div class='projects mt-5'>
  <tbs-progress indeterminate value="$ctrl.projectsReady" description='Projects'>
  </tbs-progress>
  <tbs-sidebar sections='$ctrl.sections'></tbs-sidebar>
  <div id="modal-image-viewer" class='modal fade' data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h4>Project Images</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <tbs-image-carousel class='full-screen-modal' images="$ctrl.currentImages"></tbs-image-carousel>
        </div>
      </div>
    </div>
  </div>
  <div class='card w-100' ng-if='$ctrl.projectsReady'>
    <ul class="list-group list-group-flush">
      <li ng-repeat="project in $ctrl.projects | orderBy:'-date'" id='project{{$index}}' class='list-group-item section-{{$index}} mb-2'>
        <div class="project-heading d-flex justify-content-between align-items-start">
          <h3>{{project.name}}</h3>
          <div>
            <button type="button" class='btn py-0 px-2 btn-outline-secondary' ng-if='project.images.length'
              ng-click='$ctrl.currentImages = project.images' data-bs-toggle="modal" data-bs-target="#modal-image-viewer">
              <span class="fa fa-images"></span>
            </button>
          </div>
        </div>
        <span class="badge bg-light text-secondary">{{project.date}}</span>
        <p class='lead'><strong>Goal: </strong>{{project.goal}}</p>
        <div id='project{{$index}}-steps' class='accordion mx-lg-5 my-4'>
          <div ng-repeat='step in project.steps' class='accordion-item'>
            <h5 id='project{{$parent.$index}}-step{{$index}}-heading' class='accordion-header'>
              <button class="accordion-button"
                ng-class="{ collapsed: !$first }" type="button" data-bs-toggle="collapse"
                data-bs-target="#project{{$parent.$index}}-step{{$index}}-detail" aria-expanded="{{ $first }}"
                aria-controls="project{{$parent.$index}}-step{{$index}}-detail">
                <small class="fa fa-check-circle me-2"></small>{{step.heading}}
              </button>
            </h5>
            <div id='project{{$parent.$index}}-step{{$index}}-detail' class='accordion-collapse collapse' ng-class="{ show: $first }"
              aria-labelledby="project{{$parent.$index}}-step{{$index}}-heading"
              data-bs-parent="#project{{$parent.$index}}-steps">
              <div class='accordion-body'>
                <p class='project-step' ng-repeat='paragraph in step.detail.split("\n")'>
                  {{paragraph}}
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body d-flex justify-content-end" ng-if='project.documents.length'>
          Give it a try! =>
          <a class='ms-3' ng-repeat='doc in project.documents' href='{{doc.path}}' target='_blank'
            rel="noopener noreferrer">{{doc.name}}</a>
        </div>
      </li>
    </ul>
  </div>
</div>
